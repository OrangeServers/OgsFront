<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>文件传输</title>

    <link rel="icon" href="/image/bitbug_favicon.ico">
    <link rel="stylesheet" href="/layui/css/layui.css">
    <link rel="stylesheet" href="/css/orange.css">

    <style>
        /*#demo6 {*/
        /*    background-image: url('image/文件夹.png');*/
        /*    background-color: Transparent;*/
        /*    background-repeat: no-repeat;*/
        /*    background-size: 100px 100px;*/
        /*    width: 100px;*/
        /*    height: 100px;*/
        /*    border: none;*/
        /*    vertical-align: bottom;*/
        /*}*/
        .orange-dir {
            /*background-image: url('image/文件夹.png');*/
            /*background-color: Transparent;*/
            /*background-repeat: no-repeat;*/
            /*background-size: 100px 100px;*/
            width: 100px;
            height: 90px;
            border: none;
            vertical-align: bottom;
        }

        .orange-dir > img {
            width: 50px;
            height: 40px;
            margin-top: 10px;
        }

        .orange-dir > p {
            color: #23262E;
            word-wrap: break-word;
            word-break: break-all;
        }

        .orange-dir:hover {
            background-color: #bfbfbf;
        }
    </style>

</head>
<body>
<div class="layui-layout layui-layout-admin">


    <div class="layui-body">

        <div class="orange-body" style="padding: 15px;">
            <p>文件管理, button内嵌套icon和p标签</p>

            <div class="file-div">
                <button class="layui-btn layui-btn-primary orange-dir" id="demo6">
                    <img src="image/文件夹2.png">
                    <p>home</p>
                </button>

            </div>

        </div>
    </div>

    <div class="layui-footer">
        <!-- 底部固定区域 -->
        <p>Copyright @ 2021-04-09 by Xuzhiwei Version1.0</p>
    </div>
</div>


<script src="/layui/layui.js"></script>
<script src="/js/jquery-3.3.1.js"></script>
<script src="/js/jquery.cookie.min.js"></script>
<script src="/js/conf.js"></script>
<script src="/js/main.js"></script>
<!-- Chart code -->

<script>
    layui.use(['dropdown', 'util', 'layer', 'table', 'element'], function () {
        let element = layui.element,
            dropdown = layui.dropdown,
            util = layui.util,
            layer = layui.layer,
            table = layui.table,
            $ = layui.jquery;

        get_user_auth_list('filetransfer')


        $.ajax({
            type: "POST",
            url: ogs_backend_url + "/local/file/def_get",
            dataType: "JSON",
            success: function (res) {
                console.log(res)
                // let html = ''
                let res_dir = res['dir']
                let res_file = res['file']
                for (let i = 0; i < res_dir.length; i++) {
                    let html = '                <button class="layui-btn layui-btn-primary orange-dir" id="orange-dir-' + i + '">\n' +
                        '                    <img src="image/文件夹2.png">\n' +
                        '                    <p>' + res_dir[i] + '</p>\n' +
                        '                </button>'
                    $(".file-div").append(html)
                    dropdown.render({
                        elem: "#orange-dir-" + i //也可绑定到 document，从而重置整个右键
                        , trigger: 'contextmenu' //contextmenu
                        , isAllowSpread: false //禁止菜单组展开收缩
                        , style: 'width: 200px' //定义宽度，默认自适应
                        , id: 'test788' //定义唯一索引
                        , data: [{
                            title: '下载'
                            , id: 'dow'
                        }, {
                            title: '重命名'
                            , id: 'rename'
                        }, {
                            title: '删除'
                            , id: 'del'
                        }]
                        , click: function (obj, othis) {
                            if (obj.id === 'test') {
                                layer.msg('click');
                            } else if (obj.id === 'print') {
                                window.print();
                            } else if (obj.id === 'reload') {
                                location.reload();
                            }
                        }
                    });
                }

                for (let y = 0; y < res_file.length; y++) {
                    let html = '                <button class="layui-btn layui-btn-primary orange-dir" id="orange-file-' + y + '">\n' +
                        '                    <img src="image/文件2.png">\n' +
                        '                    <p>' + res_file[y] + '</p>\n' +
                        '                </button>'
                    $(".file-div").append(html)
                    dropdown.render({
                        elem: "#orange-file-" + y //也可绑定到 document，从而重置整个右键
                        , trigger: 'contextmenu' //contextmenu
                        , isAllowSpread: false //禁止菜单组展开收缩
                        , style: 'width: 200px' //定义宽度，默认自适应
                        , id: 'test799' //定义唯一索引
                        , data: [{
                            title: '下载'
                            , id: 'test'
                        }, {
                            title: '重命名'
                            , id: 'print'
                        }, {
                            title: '删除'
                            , id: 'reload'
                        }]
                        , click: function (obj, othis) {
                            if (obj.id === 'test') {
                                layer.msg('click');
                            } else if (obj.id === 'print') {
                                window.print();
                            } else if (obj.id === 'reload') {
                                location.reload();
                            }
                        }
                    });
                }
                // $(".file-div").html(html)
                element.init()
            }
        })

        //自定义事件 - dblclick 双击
        dropdown.render({
            elem: '#demo6'
            , trigger: 'dblclick'
            , data: [{
                title: 'menu item 1'
                , id: 100
            }, {
                title: 'menu item 2'
                , id: 101
            }, {
                title: 'menu item 3'
                , id: 102
            }]
        });

        //右键菜单
        // var inst = dropdown.render({
        //     elem: document //也可绑定到 document，从而重置整个右键
        //     , trigger: 'contextmenu' //contextmenu
        //     , isAllowSpread: false //禁止菜单组展开收缩
        //     , style: 'width: 200px' //定义宽度，默认自适应
        //     , id: 'test777' //定义唯一索引
        //     , data: [{
        //         title: 'menu item 1'
        //         , id: 'test'
        //     }, {
        //         title: 'Printing'
        //         , id: 'print'
        //     }, {
        //         title: 'Reload'
        //         , id: 'reload'
        //     }]
        //     , click: function (obj, othis) {
        //         if (obj.id === 'test') {
        //             layer.msg('click');
        //         } else if (obj.id === 'print') {
        //             window.print();
        //         } else if (obj.id === 'reload') {
        //             location.reload();
        //         }
        //     }
        // });

    })
</script>
</body>
</html>
